"""
DATA SOURCE INTEGRATION GUIDE
==============================

ุชุญูู ูุดฺฉูุงุช ู ุฑุงูโุญูโูุง ุงุชุตุงู ุจู ููุงุจุน ุฏุงุฏู ูุฑฺฉุฒ
"""

# ==============================================================================
# 1. ูุดฺฉูุงุช ูุงู ูุฑูุฏ (symbols.csv) ู ุฏูุงู ุขู
# ==============================================================================

PROBLEMS = {
    "ูุดฺฉู 1: ูุฑูุช ูุงููุธู": {
        "ุชูุถุญ": """
        โข ุณุทุฑ 0: ุฎุงู
        โข ุณุทุฑ 1: ูุชุงุฏุชุง (ุชุงุฑุฎ ู ุฒูุงู)
        โข ุณุทุฑ 2: ูุงู ุณุชููโูุง
        โข ุณุทุฑ 3+: ุฏุงุฏูโูุง
        
        ูุงุฒ ุจู skiprows=2 ุจุฑุง ูพุงุฑุณ ุตุญุญ
        """,
        "ุญู": "ุงุณุชูุงุฏู ุงุฒ parser ุณูุงุฑุด"
    },
    
    "ูุดฺฉู 2: ูุงู ุณุชููโูุง ูุงุฑุณ": {
        "ุชูุถุญ": """
        โข ุณุชููโูุง ูุงุฑุณ encoding UTF-8 ุฑุง ูุงุฒ ุฏุงุฑูุฏ
        โข Space ูุง ุงุถุงู ุฏุฑ ูุงูโูุง (ูุซูุงู ' ุญุฌู' ุจู ุฌุง 'ุญุฌู')
        โข Inconsistent naming
        """,
        "ุญู": "mapping ุณุชููโูุง ุจู ูุงูโูุง ุงุณุชุงูุฏุงุฑุฏ"
    },
    
    "ูุดฺฉู 3: ุฏุงุฏูโูุง ูุงูุต ุง ูุงูุนุชุจุฑ": {
        "ุชูุถุญ": """
        โข ุณุทุฑูุง ุฎุงู ุง ุจุง ููุฏุงุฑ 0
        โข ููุงุฏูุง ุบุฑูุนุงู (ุตูุฏููโูุงุ ุงูุฑุงู ูุฑุถู)
        โข ููุงุฏุฑ NaN ุง ุบุฑุนุฏุฏ
        """,
        "ุญู": "Filtering ู validation ูุจู ุงุฒ ุงุณุชูุงุฏู"
    },
    
    "ูุดฺฉู 4: ุชููุง snapshot ูุญุธูโุง": {
        "ุชูุถุญ": """
        โข ูุงู ุดุงูู ููุท ุขุฎุฑู ููุช ูุณุช
        โข ุจุฑุง ุชุญูู ุชฺฉูฺฉุงู ูุงุฒ ุจู ุชุงุฑุฎฺ 260 ุฑูุฒ ุงุณุช
        โข ุฏุงุฏูโูุง ุงุณุชุง ุจุฑุง ุชุนู ุฑููุฏ ุงุณุชูุงุฏูโุง ูุฏุงุฑูุฏ
        """,
        "ุญู": "ุฏุฑุงูุช ุฏุงุฏูโูุง ุชุงุฑุฎ ุงุฒ API TSE ุง ุฎุฏูุงุช ุฏุงุฏู"
    },
    
    "ูุดฺฉู 5: ุนุฏู Real-time ุจูุฏู": {
        "ุชูุถุญ": """
        โข ุฏุงุฏูโูุง ูุงู ุซุงุจุช ูุณุชูุฏ (ุงุฒ ุชุงุฑุฎ 1404/09/19)
        โข ุงุณฺฉุฑูพุช ุชุณุช ุฏุงุฏูโูุง ูุตููุน ุชููุฏ ูโฺฉูุฏ
        โข ุจุฑุง ุงุณุชูุงุฏู ูุงูุน ูุงุฒ ุจู ุงุทูุงุนุงุช ุฑูุฒุฑุณุงู ุฏุงุฑุฏ
        """,
        "ุญู": "ุงุชุตุงู ุจู API ูุง ูุงู ุง ุฏุชุงุจุณ"
    }
}

# ==============================================================================
# 2. ููุงุจุน ุฏุงุฏู TSE / ุจูุฑุณ ุงุฑุงู
# ==============================================================================

DATA_SOURCES = {
    "API ุฑุณู TSE": {
        "ูุงู": "Tehran Stock Exchange API",
        "ุณุงุช": "https://www.tsetmc.com",
        "ุชูุถุญ": """
        โข ุงุทูุงุนุงุช ุฑุณู ุจูุฑุณ
        โข ุจุฏูู ูุงุฒ ุจู ุซุจุชโูุงู
        โข ูุญุฏูุฏุชโูุง ูุฑุฎ ุฏุฑุฎูุงุณุช
        """,
        "ูุฒุงุง": ["ุฑุณู", "ูุงุจู ุงุนุชูุงุฏ", "ุฑุงฺฏุงู"],
        "ูุนุงุจ": ["Rate limiting", "API ูพุงุฏุงุฑ ูุณุช", "ูพุดุชุจุงู ุถุนู"],
        "ูุซุงู": """
        https://tsetmc.com/tsev2/data/instinfodata/{symbol}.json
        https://tsetmc.com/tsev2/data/dailytradesdata/{symbol}/latest.json
        """
    },
    
    "Tsetmc Client (Python Library)": {
        "ูุงู": "tsetmc-client",
        "ุณุงุช": "https://github.com/amirkhani/tsetmc-client",
        "ุชูุถุญ": """
        โข ฺฉุชุงุจุฎุงู Python ุจุฑุง ุงุชุตุงู ุจู TSE
        โข ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏูโูุง
        โข ูุฏุฑุช ุฎุทุง
        """,
        "ูุฒุงุง": ["ุขุณุงู ุงุณุชูุงุฏู", "ูุนุงูุฌ ุฎุทุง", "ูพุงฺฉุณุงุฒ ุฏุงุฏู"],
        "ูุนุงุจ": ["ุจูโุฑูุฒุฑุณุงู ูุงููุธู", "ุงุนุชูุงุฏ ุจู ุชูุณุนูโุฏููุฏ ุดุฎุต"],
        "ูุตุจ": "pip install tsetmc-client",
        "ูุซุงู_ฺฉุฏ": """
        from tsetmc_client import TSEClient
        client = TSEClient()
        data = client.get_daily_data('ููุงุฏ')
        """
    },
    
    "Tadbit API": {
        "ูุงู": "Tadbit (ุฎุฏู ุงุทูุงุนุงุช ุจูุฑุณ)",
        "ุณุงุช": "https://tadbit.ir",
        "ุชูุถุญ": """
        โข ุณุฑูุณ ุชุฌุงุฑ ุงุทูุงุนุงุช ุจูุฑุณ
        โข API REST ู WebSocket
        โข ุฏุงุฏูโูุง Real-time ู ุชุงุฑุฎ
        """,
        "ูุฒุงุง": ["ูุงุจู ุงุนุชูุงุฏ", "Real-time", "ูพุดุชุจุงู"],
        "ูุนุงุจ": ["ูุญุฏูุฏ ุจู ุงุดุชุฑุงฺฉ", "ูุฒูู"],
        "ูุซุงู": "ูุงุฒ ุจู API key"
    },
    
    "Yahoo Finance (International)": {
        "ูุงู": "yfinance",
        "ุณุงุช": "https://github.com/ranaroussi/yfinance",
        "ุชูุถุญ": """
        โข ุฏุงุฏูโูุง ุฌูุงู (ุจุฑุง ููุงุณู)
        โข ุชุงุฑุฎ ู Real-time
        โข Reliable ู ุฑุงฺฏุงู
        """,
        "ูุฒุงุง": ["ุฑุงฺฏุงู", "ูุงุจู ุงุนุชูุงุฏ", "ุจุฏูู API key"],
        "ูุนุงุจ": ["ููุท ุจุงุฒุงุฑูุง ุจูโุงูููู", "ุจุฑุง TSE ุจโุงุณุชูุงุฏู"],
        "ูุตุจ": "pip install yfinance"
    }
}

# ==============================================================================
# 3. ุฑุงูโุญูโูุง ูพุดููุงุฏ (ุชุฏุฑุฌ)
# ==============================================================================

SOLUTIONS = {
    "ุณุทุญ 1: ุจูุจูุฏ Parser ูุงู ููุฌูุฏ": {
        "ุตุนูุจุช": "ุขุณุงู",
        "ูุฏุช": "30 ุฏููู",
        "ูุฑุงุญู": """
        1. Robust parsing ุจุฑุง ูุงู CSV
        2. Validation ู filtering
        3. Caching ุฏุฑูู ุญุงูุธู (RAM)
        """,
        "ูุงู": "src/data_loader.py",
        "ูุฒุงุง": ["ุจุฏูู ูุงุจุณุชฺฏ ุจุฑูู", "ุณุฑุน", "ุขุณุงู ุฑุงูโุงูุฏุงุฒ"],
        "ูุนุงุจ": ["ููุท ุชุงุฑุฎ ุซุงุจุช", "ูุงุฒ ุจู ุขูพุฏุช ุฏุณุช"]
    },
    
    "ุณุทุญ 2: ุงุชุตุงู ุจู TSE API": {
        "ุตุนูุจุช": "ูุชูุณุท",
        "ูุฏุช": "2-3 ุณุงุนุช",
        "ูุฑุงุญู": """
        1. ูุตุจ tsetmc-client
        2. Wrapper ุจุฑุง ุงุชุตุงู
        3. Caching ู DB ุฐุฎุฑูโุณุงุฒ
        4. Exception handling
        """,
        "ูุงู": "src/tse_connector.py",
        "ูุฒุงุง": ["ุฏุงุฏูโูุง ุขูพุฏุช ุดุฏู", "API ุฑุณู", "ุฑุงฺฏุงู"],
        "ูุนุงุจ": ["Rate limiting", "Stability issues"],
        "ูุตุจ_ูุงุจุณุชฺฏ": "pip install tsetmc-client"
    },
    
    "ุณุทุญ 3: Database ูุฑฺฉุฒ (ุจูุชุฑู ุญู)": {
        "ุตุนูุจุช": "ูุชูุณุท - ุณุฎุช",
        "ูุฏุช": "4-6 ุณุงุนุช",
        "ูุฑุงุญู": """
        1. SQLite ุง PostgreSQL
        2. Scheduler (APScheduler) ุจุฑุง ุขูพุฏุช
        3. API ุจุฑุง ุฏุณุชุฑุณ
        4. Historical data sync
        """,
        "ูุงู": "src/db_manager.py",
        "ูุฒุงุง": ["Query ุณุฑุน", "Historical", "Reliable", "Scalable"],
        "ูุนุงุจ": ["ูพฺุฏูโุชุฑ", "ูุงุฒ ุจู ูฺฏูุฏุงุฑ"]
    },
    
    "ุณุทุญ 4: Hybrid (ุจูุชุฑู ุนูู)": {
        "ุตุนูุจุช": "ุณุฎุช",
        "ูุฏุช": "8-10 ุณุงุนุช",
        "ูุฑุงุญู": """
        1. SQLite ูุญู
        2. Sync with TSE API ุฑูุฒุงูู
        3. Cache layer
        4. Fallback to CSV
        5. Real-time updates
        """,
        "ูุงู": "src/hybrid_data_manager.py",
        "ูุฒุงุง": ["ุณุฑุน", "Reliable", "Real-time + Historical"],
        "ูุนุงุจ": ["ูพฺุฏูโุชุฑ"]
    }
}

# ==============================================================================
# 4. ูพุงุฏูโุณุงุฒ Step-by-Step
# ==============================================================================

print(__doc__)

print("\n" + "="*80)
print("ูุดฺฉูุงุช ูุงู ูุฑูุฏ (symbols.csv):")
print("="*80)
for issue, details in PROBLEMS.items():
    print(f"\nโ {issue}")
    print(f"  ๐ {details['ุชูุถุญ']}")
    print(f"  โ ุญู: {details['ุญู']}")

print("\n" + "="*80)
print("ููุงุจุน ุฏุงุฏู ุฏุณุชุฑุณโูพุฐุฑ:")
print("="*80)
for source, info in DATA_SOURCES.items():
    print(f"\n๐ก {info['ูุงู']}")
    print(f"   URL: {info.get('ุณุงุช', 'N/A')}")
    print(f"   {info['ุชูุถุญ']}")
    if 'ูุฒุงุง' in info:
        print(f"   โ {', '.join(info['ูุฒุงุง'])}")
    if 'ูุนุงุจ' in info:
        print(f"   โ {', '.join(info['ูุนุงุจ'])}")

print("\n" + "="*80)
print("ุฑุงูโุญูโูุง ูพุดููุงุฏ:")
print("="*80)
for level, solution in SOLUTIONS.items():
    print(f"\n๐ง {level}")
    print(f"   ุตุนูุจุช: {solution['ุตุนูุจุช']} | ูุฏุช: {solution['ูุฏุช']}")
    print(f"   ูุงู: {solution['ูุงู']}")
    print(f"   โ {', '.join(solution['ูุฒุงุง'])}")
    print(f"   โ {', '.join(solution['ูุนุงุจ'])}")

print("\n" + "="*80)
print("\nุชูุตู: ุณุทุญ 3 (Database) ุง ุณุทุญ 4 (Hybrid) ุจุฑุง ูพุฑูฺ production")
print("="*80)
